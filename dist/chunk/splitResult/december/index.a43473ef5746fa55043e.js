(window.webpackJsonpso=window.webpackJsonpso||[]).push([[8],{147:function(t,e,n){var a=n(148);"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);(0,n(6).default)("2bfa7deb",a,!1,{})},148:function(t,e,n){(t.exports=n(1)(!1)).push([t.i,"\n.december {\n  padding: 12px;\n}\n.december .splitBtn {\n  margin-bottom: 10px;\n  border-top: 1px solid #e2e2e2;\n  padding-top: 10px;\n  margin-top: -9px;\n}\n.december .checkBoxListLen {\n  position: absolute;\n  top: 8px;\n}\n.december .checkBoxListLen code {\n  color: red;\n}\n",""])},149:function(t,e,n){"use strict";n.r(e);var a=n(74),o=n.n(a);for(var r in a)"default"!==r&&function(t){n.d(e,t,function(){return a[t]})}(r);var i=n(152),s=n(0),l=!1;var m=function(t){l||n(150)},c=Object(s.a)(o.a,i.a,i.b,!1,m,null,null);c.options.__file="src\\page\\bonus\\splitResult\\december\\list.vue",e.default=c.exports},150:function(t,e,n){var a=n(151);"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);(0,n(6).default)("199bddca",a,!1,{})},151:function(t,e,n){(t.exports=n(1)(!1)).push([t.i,"\n.decemberList .salarysItem {\n  margin-top: 5px;\n}\n.decemberList .ivu-form-item {\n  margin-bottom: 10px;\n}\n.decemberList .preview {\n  margin-bottom: 3px;\n  padding-top: 10px;\n}\n.decemberList .preview header {\n  padding: 12px 0 6px;\n  margin-bottom: 12px;\n  border-bottom: 1px solid #dddddd;\n}\n.decemberList .preview .partitionOk {\n  margin-top: -50px;\n  margin-bottom: 13px;\n  text-align: right;\n}\n.decemberList .table {\n  margin-top: 10px;\n}\n.decemberList .toast {\n  font-size: 12px;\n}\n.decemberList .toast span {\n  color: red;\n  font-size: 12px;\n}\n.decemberList .ivu-table-fixed .ivu-table-fixed-body {\n  height: 459px !important;\n}\n.isShowSplitModal6 .ivu-modal-mask,\n.isShowSplitModal6 .ivu-modal-wrap {\n  z-index: 1001;\n}\n.isShowSplitModal6 .red {\n  color: red;\n  font-size: 12px;\n}\n.isShowSplitModal6 p {\n  padding-bottom: 8px;\n}\n.isShowSplitModal6 .isOk {\n  font-size: 14px;\n  font-weight: bold;\n}\n",""])},152:function(t,e,n){"use strict";n.d(e,"a",function(){return a}),n.d(e,"b",function(){return o});var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("Modal",{staticClass:"decemberList",attrs:{title:t.titleComputed,"mask-closable":!1,width:"90%"},on:{"on-cancel":t.onCancel},model:{value:t.december.modal1,callback:function(e){t.$set(t.december,"modal1",e)},expression:"december.modal1"}},[n("Form",{ref:"formValidate",attrs:{model:t.form,"label-width":120}},[n("Card",[n("Row",[n("Col",{attrs:{span:"10"}},[n("FormItem",{attrs:{label:"剩余金额指定到："}},[n("DatePicker",{attrs:{editable:!1,type:"month",format:"yyyy-MM",placeholder:"请选择"},on:{"on-change":t.resetTable},model:{value:t.form.adjustgrantMonth,callback:function(e){t.$set(t.form,"adjustgrantMonth",e)},expression:"form.adjustgrantMonth"}}),t._v(" 月发放\n        ")],1)],1),t._v(" "),n("Col",{staticClass:"salarysItem",attrs:{span:"5"}},[n("Checkbox",{on:{"on-change":t.resetTable},model:{value:t.form.monthShares,callback:function(e){t.$set(t.form,"monthShares",e)},expression:"form.monthShares"}},[t._v("12月分摊")]),t._v(" "),n("Checkbox",{on:{"on-change":t.resetTable},model:{value:t.form.multiSalarys,callback:function(e){t.$set(t.form,"multiSalarys",e)},expression:"form.multiSalarys"}},[t._v("多次发薪")])],1),t._v(" "),n("Col",{attrs:{span:"5"}},[n("Button",{attrs:{disabled:!t.form.adjustgrantMonth,type:"primary"},on:{click:t.splitPreview}},[t._v("分拆预览")])],1)],1),t._v(" "),n("Row",{staticClass:"preview"},[n("Col",[n("header",[t._v("预览")])]),t._v(" "),n("Col",{staticClass:"partitionOk",attrs:{align:"center"}},[n("Button",{attrs:{disabled:!t.form.adjustgrantMonth,type:"primary"},on:{click:t.exportOriginal}},[t._v("导出原始奖金数据")]),t._v(" "),n("Button",{attrs:{disabled:!t.form.adjustgrantMonth,type:"primary"},on:{click:t.splitResult}},[t._v("导出分拆结果")]),t._v(" "),n("Button",{attrs:{disabled:!t.form.adjustgrantMonth||t.december.table.data1.length<=0,type:"primary"},on:{click:t.asyncOK}},[t._v("确认分拆")])],1)],1),t._v(" "),n("Row",[n("Col",[n("p",{staticClass:"toast"},[t._v("\n          共分拆员工\n          "),n("span",[t._v(t._s(t.emplData.checkBoxList.length))]),t._v(" 个，分拆后生成\n          "),n("span",[t._v(" "+t._s(t.december.table.data1.length)+" ")]),t._v("条奖金数据，\n          奖金总额："),n("span",[t._v(t._s(t._f("formatMoney")(t.form.totalBonus,2)))]),t._v("，分拆总金额：\n          "),n("span",[t._v(t._s(t._f("formatMoney")(t.form.uncoveringTotalBonus,2)))]),t._v("。\n        ")])]),t._v(" "),n("Col",{staticClass:"table"},[n("Table",{ref:"previewSelection",attrs:{loading:t.december.table.loading,columns:t.december.table.columns4,data:t.december.table.data1,height:"500",border:""}})],1)],1)],1)],1),t._v(" "),n("div",{attrs:{slot:"footer"},slot:"footer"},[n("Button",{attrs:{type:"primary"},on:{click:t.onCancel}},[t._v("关闭")])],1),t._v(" "),n("Modal",{staticClass:"isShowSplitModal6",attrs:{loading:t.isSplit.loading,"mask-closable":!1,title:"操作信息"},on:{"on-ok":t.splitSubmit},model:{value:t.isSplit.modal6,callback:function(e){t.$set(t.isSplit,"modal6",e)},expression:"isSplit.modal6"}},[n("p",[t._v(t._s(t.isSplit.message))]),t._v(" "),n("p",[t._v("奖金总额："),n("span",{staticClass:"red"},[t._v(t._s(t._f("formatMoney")(t.form.totalBonus,2)))])]),t._v(" "),n("p",[t._v("分拆总金额："),n("span",{staticClass:"red"},[t._v(t._s(t._f("formatMoney")(t.form.uncoveringTotalBonus,2)))])]),t._v(" "),n("p",[t._v("剩余金额指定到 "),n("span",{staticClass:"red"},[t._v(t._s(t._f("formatDate")(t.form.adjustgrantMonth,"yyyy-MM")))]),t._v(" 月发放")]),t._v(" "),n("p",{staticClass:"isOk"},[t._v("确认要分拆吗？")])])],1)},o=[];a._withStripped=!0},153:function(t,e,n){"use strict";n.d(e,"a",function(){return a}),n.d(e,"b",function(){return o});var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("XFrame",{staticClass:"december"},[n("Card",[n("Form",{attrs:{"label-width":80}},[n("Row",[n("Col",{attrs:{span:"5"}},[n("FormItem",{attrs:{label:"奖金发放月"}},[n("DatePicker",{attrs:{type:"month",placeholder:"Select date"},on:{"on-change":t.resetTable},model:{value:t.form.grantMonth,callback:function(e){t.$set(t.form,"grantMonth","string"==typeof e?e.trim():e)},expression:"form.grantMonth"}})],1)],1),t._v(" "),n("Col",{attrs:{span:"5"}},[n("FormItem",{attrs:{label:"批次"}},[n("Select",{on:{"on-change":t.resetTable},model:{value:t.form.multiSalary,callback:function(e){t.$set(t.form,"multiSalary",e)},expression:"form.multiSalary"}},[n("Option",{attrs:{value:"1"}},[t._v("1")]),t._v(" "),n("Option",{attrs:{value:"2"}},[t._v("2")])],1)],1)],1),t._v(" "),n("Col",{attrs:{span:"5"}},[n("FormItem",[n("Button",{attrs:{disabled:!t.form.multiSalary||!t.form.grantMonth,type:"primary"},on:{click:t.getRoster}},[t._v("获取名单")])],1)],1)],1),t._v(" "),n("Row",[t.formDynamic.checkBoxList.length>0?n("p",{staticClass:"checkBoxListLen"},[t._v("\n          共选中"),n("code",[t._v(" "+t._s(t.formDynamic.checkBoxList.length)+" ")]),t._v("条数据\n        ")]):t._e(),t._v(" "),n("Col",{staticClass:"splitBtn",attrs:{align:"right"}},[n("Button",{attrs:{disabled:t.formDynamic.checkBoxList.length<=0,type:"primary"},on:{click:t.showSplitItem}},[t._v("分拆")])],1),t._v(" "),n("Col",[n("Table",{attrs:{columns:t.formDynamic.columns1,data:t.formDynamic.data2,loading:t.formDynamic.loading,height:"660",stripe:""},on:{"on-selection-change":t.selectionChange}})],1)],1)],1)],1),t._v(" "),n("List",{ref:"decemberList",attrs:{"empl-form":t.form,"empl-data":t.formDynamic},on:{getRoster:t.getRoster}})],1)},o=[];a._withStripped=!0},50:function(t,e,n){"use strict";n.r(e);var a=n(73),o=n.n(a);for(var r in a)"default"!==r&&function(t){n.d(e,t,function(){return a[t]})}(r);var i=n(153),s=n(0),l=!1;var m=function(t){l||n(147)},c=Object(s.a)(o.a,i.a,i.b,!1,m,null,null);c.options.__file="src\\page\\bonus\\splitResult\\december\\index.vue",e.default=c.exports},73:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=function(t){return t&&t.__esModule?t:{default:t}}(n(15));e.default={components:{List:n(149).default},data:function(){return{form:{multiSalary:"",grantMonth:""},formDynamic:{checkBoxList:[],data2:[],columns1:[{type:"selection",width:60,align:"center"},{title:"工号",key:"emplId"},{title:"姓名",key:"emplName"},{title:"部门",key:"depName"},{title:"奖金总额",key:"bonusValue"}],loading:!1}}},methods:{getRoster:function(){var t=this.form,e=this;e.formDynamic.loading=!0,a.default.getRoster({form:t,success:function(t){e.formDynamic.loading=!1,0===t.status?(e.formDynamic.data2=t.data||[],e.formDynamic.checkBoxList=[]):e.$Message.info(t.statusText||"服务器异常，请联系管理员")},error:function(t){e.formDynamic.loading=!1,e.$Message.error(t)}})},selectionChange:function(t){var e=this;this.formDynamic.checkBoxList=[],t.map(function(t){return e.formDynamic.checkBoxList.push(t.emplId)})},showSplitItem:function(){this.$refs.decemberList.december.modal1=!0,this.$refs.decemberList.form.adjustgrantMonth="",this.$refs.decemberList.form.multiSalarys=!1,this.$refs.decemberList.form.monthShares=!1,this.$refs.decemberList.december.table.data1=[],this.$refs.decemberList.december.table.loading=!1},resetTable:function(){this.formDynamic.checkBoxList=[],this.formDynamic.data2=[]}}}},74:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=function(t){return t&&t.__esModule?t:{default:t}}(n(15));e.default={props:{emplData:{type:Object,default:function(){}},emplForm:{type:Object,default:function(){}}},data:function(){var t=this;return{form:{adjustgrantMonth:"",multiSalarys:!1,monthShares:!1,uncoveringTotalBonus:"",totalBonus:""},december:{modal1:!1,table:{columns4:[{title:"工号",key:"emplId",minWidth:120,align:"center",fixed:"left"},{title:"姓名",key:"emplName",minWidth:120,align:"center",fixed:"left"},{title:"职级",key:"jobRank",minWidth:120,align:"center"},{title:"职位",key:"jobPost",minWidth:200},{title:"部门",key:"depName",minWidth:120},{title:"奖金类型",key:"bonusTypeName",minWidth:120},{title:"奖金名称",key:"bonusName",minWidth:400},{title:"奖金总额",key:"bonusValue",minWidth:120},{title:"奖金金额",key:"grantValue",minWidth:120},{title:"奖金发放月",key:"grantMonth",minWidth:100,render:function(e,n){return e("span",t.formatDate(n.row.grantMonth))}},{title:"发放状态",key:"status",minWidth:80,render:function(t,e){var n="未发放";return 3===e.row.status&&(n="已发放"),t("span",n)}},{title:"是否多次发薪",key:"multiSalary",align:"center",minWidth:100,render:function(t,e){var n="是";return 2===e.row.multiSalary&&(n="否"),t("span",n)}},{title:"是否12月分摊",key:"monthShare",align:"center",minWidth:100,render:function(t,e){var n="是";return 2===e.row.monthShare&&(n="否"),t("span",n)}},{title:"分拆金额",key:"uncoveringValue",align:"center",minWidth:100},{title:"分拆金额发放月",key:"uncoveringMonth",align:"center",minWidth:100,render:function(e,n){return e("span",t.formatDate(n.row.uncoveringMonth))}},{title:"发放状态",key:"uncoveringStatus",align:"center",minWidth:100,render:function(t,e){var n="未发放";return 3===e.row.uncoveringStatus&&(n="已发放"),t("span",n)}},{title:"是否多次发薪",key:"uncoveringMultiSalary",align:"center",minWidth:100,render:function(t,e){var n="是";return 2===e.row.uncoveringMultiSalary&&(n="否"),t("span",n)}},{title:"是否12月分摊",key:"uncoveringMonthShare",align:"center",minWidth:100,render:function(t,e){var n="是";return 2===e.row.uncoveringMonthShare&&(n="否"),t("span",n)}}],data1:[],loading:!1}},isSplit:{modal6:!1,loading:!1,message:""}}},computed:{titleComputed:function(){return"共选中 "+this.emplData.checkBoxList.length+" 位员工"}},methods:{moneyFormat:function(t){return utils.number_format({decimals:2,number:t,dec_point:".",thousands_sep:","})},asyncOK:function(){var t=this;a.default.monthShareCheck({data:t.getParams(),success:function(e){t.isSplit.modal6=!0,t.isSplit.loading=!0,t.isSplit.message=e.statusText},error:function(e){t.$Message.error(e)}})},splitSubmit:function(){var t=this;a.default.monthShareConfirm({data:t.getParams(),success:function(e){if(0===e.status){t.isSplit.modal6=!1,t.isSplit.loading=!1;var n=t.form.adjustgrantMonth&&new Date(t.form.adjustgrantMonth).format("yyyy-MM"),a=t.moneyFormat(t.form.totalBonus),o=t.moneyFormat(t.form.uncoveringTotalBonus);t.$Modal.success({title:"操作成功",content:"<article class='isShowSplitModal6'><p>"+t.isSplit.message+'</p><p>奖金总额：<span class="red">'+a+'</span></p><p>分拆总金额：<span class="red">'+o+"</span></p><p>剩余金额指定到 <span class='red'>"+n+"</span> 月发放</p></p></article>",onOk:function(){t.december.modal1=!1,t.form.uncoveringTotalBonus="",t.form.totalBonus="",t.$emit("getRoster")}}),t.isSplit.message=""}else t.$Message.info(e.statusText||"服务器异常，请联系管理员")},error:function(e){t.$Message.error(e)}})},splitResult:function(){var t=this.getParams();window.location.href=utils.url.curr+"/sylla/phr-ui/bonus/monthShare/split?"+t},formatDate:function(t){return t?new Date(t).Format("yyyy-MM"):""},splitPreview:function(){var t=this,e=t.getParams();a.default.getPreview({data:e,success:function(e){0===e.status?(t.december.table.data1=[].concat(function(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}(e.data.list)),t.form.totalBonus=e.data.totalBonus,t.form.uncoveringTotalBonus=e.data.uncoveringTotalBonus):t.$Message.info(e.statusText||"服务器异常，请联系管理员")},error:function(e){t.$Message.error(e)}})},onCancel:function(){this.december.modal1=!1,this.form.uncoveringTotalBonus="",this.form.totalBonus=""},getParams:function(){var t={grantMonth:this.emplForm.grantMonth?new Date(this.emplForm.grantMonth).format("yyyy-MM"):"",multiSalary:this.emplForm.multiSalary,emplIds:this.emplData.checkBoxList.join(","),adjustgrantMonth:this.form.adjustgrantMonth?new Date(this.form.adjustgrantMonth).format("yyyy-MM"):"",adjustmultiSalary:this.form.multiSalarys?1:2,adjustmonthShare:this.form.monthShares?1:2},e=[];for(var n in t)e.push(encodeURIComponent(n)+"="+encodeURIComponent(t[n]));return e.join("&")},exportOriginal:function(){var t=this.getParams();window.location.href=utils.url.curr+"/sylla/phr-ui/bonus/monthShare/normal?"+t},resetTable:function(){this.december.table.data1=[],this.december.table.loading=!1,this.form.uncoveringTotalBonus="",this.form.totalBonus=""}}}}}]);
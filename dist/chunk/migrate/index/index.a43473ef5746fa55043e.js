(window.webpackJsonpso=window.webpackJsonpso||[]).push([[11],{160:function(t,r,e){var n=e(161);"string"==typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);(0,e(6).default)("af499808",n,!1,{})},161:function(t,r,e){(t.exports=e(1)(!1)).push([t.i,'\n.migrate {\n  cursor: pointer;\n  padding: 12px;\n}\n.migrate .formItem {\n  padding: 6px 12px;\n  margin: 0px auto;\n}\n.migrate .required .ivu-form-item-label:before {\n  content: "*";\n  color: red;\n  font-weight: bold;\n}\n.migrate .requiredError .ivu-select-selection,\n.migrate .requiredError .ivu-input {\n  border: 1px solid #ffd0ce;\n}\n.migrate .btns {\n  display: flex;\n  display: -webkit-box;\n}\n.migrate .btns .importLog {\n  margin-left: 16px;\n}\n.migrate .downBtns {\n  padding: 6px 12px;\n  margin: 0;\n}\n.migrate-table {\n  margin-top: 12px;\n}\n.migrate-table th {\n  font-size: 12px;\n}\n.migrate-table td {\n  font-size: 12px;\n}\n.migrate-table .export {\n  position: absolute;\n  right: 0;\n  top: -30px;\n}\n.migrate-table .moneyCount {\n  width: calc(100% - 190px);\n  margin-bottom: 18px;\n  color: #222222;\n  font-size: 12px;\n}\n.migrate-table .moneyCount span {\n  color: red;\n}\n.migrate-table .preprocessing {\n  color: #999999;\n  font-size: 14px;\n  margin-bottom: 12px;\n}\n.migrate .ivu-table .demo-table-error-row td {\n  background-color: rgba(241, 67, 67, 0.5);\n  color: #fff;\n}\n.migrate .ivu-table .demo-table-info-row td {\n  background-color: #2db7f5;\n  color: #fff;\n}\n.migrate .red {\n  color: red;\n  font-size: 14px;\n  font-family: sans-serif;\n}\n.migrate .ff6600 td {\n  background-color: #f5f1c6;\n  color: #333333;\n}\n',""])},162:function(t,r,e){"use strict";e.d(r,"a",function(){return n}),e.d(r,"b",function(){return a});var n=function(){var t=this,r=t.$createElement,e=t._self._c||r;return e("XFrame",{staticClass:"migrate"},[e("Card",[e("Form",{attrs:{"label-width":80}},[e("Row",[e("Col",{attrs:{span:"10"}},[e("FormItem",{staticClass:"downBtns required",attrs:{label:"上传类型"}},[e("Select",{class:t.form.type?"":"requiredError",attrs:{filterable:""},model:{value:t.form.type,callback:function(r){t.$set(t.form,"type",r)},expression:"form.type"}},t._l(t.downTemplate,function(r){return e("Option",{key:r.value,attrs:{value:r.value}},[t._v(t._s(r.label))])}))],1)],1),t._v(" "),e("Col",{staticClass:"formItem btns",attrs:{span:"7"}},[e("Upload",{ref:"upload",attrs:{action:t.actionUpload,"show-upload-list":!1,format:["xls","xlsx"],"on-format-error":t.formatErrorUpload,data:t.form,"on-progress":t.onProgress,"on-success":t.uploadSuccess,"on-error":t.uploadError}},[e("Button",{staticStyle:{width:"86px"},attrs:{type:"primary"}},[t._v("导入")])],1)],1)],1)],1)],1),t._v(" "),e("Card",{staticClass:"batch-table"},[e("Row",[e("Col",{staticClass:"moneyCount"},[t._v("\n      共导入员工\n      "),e("span",[t._v(t._s(t.table.totalNum))]),t._v(" 个,\n      正确员工\n      "),e("span",[t._v(t._s(t.table.validNum))]),t._v(" 个,\n      存在问题员工\n      "),e("span",{staticStyle:{color:"red"}},[t._v(t._s(t.table.errorNum))]),t._v(" 个\n\n\n      ")]),t._v(" "),e("Col",{staticClass:"preprocessing",attrs:{span:"1"}},[t._v("预览")]),t._v(" "),e("Col",{staticClass:"export"},[e("Button",{staticStyle:{width:"86px"},attrs:{type:"primary"},on:{click:t.asyncConfigOK}},[t._v("提交")])],1)],1),t._v(" "),e("Row",[e("Table",{ref:"table",attrs:{"row-class-name":t.rowClassName,columns:t.table.tableColumns1,data:t.table.data,height:"530"}})],1)],1),t._v(" "),t.spinShow?e("Spin",{attrs:{size:"large",fix:""}}):t._e()],1)},a=[];n._withStripped=!0},53:function(t,r,e){"use strict";e.r(r);var n=e(77),a=e.n(n);for(var o in n)"default"!==o&&function(t){e.d(r,t,function(){return n[t]})}(o);var i=e(162),s=e(0),l=!1;var u=function(t){l||e(160)},c=Object(s.a)(a.a,i.a,i.b,!1,u,null,null);c.options.__file="src\\page\\bonus\\migrate\\index.vue",r.default=c.exports},77:function(t,r,e){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=function(t){return t&&t.__esModule?t:{default:t}}(e(15));r.default={components:{},data:function(){return{form:{type:""},spinShow:!1,dataId:"",downTemplate:[{value:"5",label:"奖金历史数据迁移"},{value:"6",label:"奖金历史数据迁移状态变更"}],table:{data:[],tableColumns1:[],totalNum:0,validNum:0,errorNum:0},isImport:!1}},computed:{actionUpload:function(){return"/sylla/phr-ui/bonus/import/start?"+this.formatForm()},rewardNameVal:function(){var t=this.form;return this.form.rewardNameVal=t.deptName+"_"+t.batchName+"_"+t.bonusTypeName}},watch:{"form.deptId":function(t){this.clearTable(),this.form.deptName=this.getName(this.$store.state.batch.deptList,t)},"table.data":function(t){for(var r=0;r<t.length;r++){if(t[r].error){this.isImport=!1;break}this.isImport=!0}},"form.type":function(){this.clearTable()}},created:function(){},methods:{isShowimport:function(){var t=this.table.data,r=!1;if(t.length>0)for(var e=0;e<t.length;e++){if(t[e].error){r=!0;break}r=!1}return r},clearTable:function(){var t=this.table;return t.data=[],t.tableColumns1=[],t.totalNum=0,t.validNum=0,t.errorNum=0,this.isImport=!1,t},onProgress:function(){this.spinShow=!0},getName:function(t,r){var e="";if(r)for(var n=0;n<t.length;n++)if(r===t[n].value){e=t[n].label||t[n].text;break}return e},rowClassName:function(t){var r="";return t.waring?r="ff6600":t.error&&(r="demo-table-error-row"),r},uploadSuccess:function(t){var r=this;0===t.status?(r.dataId=t.data,n.default.getErrorWarningGrid({dataId:t.data,success:function(t){r.spinShow=!1;var e=t.data;if(t){for(var n=[{key:"errorMsg",title:"提示信息",minWidth:160,align:"center"}],a=0;a<e.columnName.length;a++)n.push({key:e.columnCode[a],title:e.columnName[a],minWidth:120});r.table.tableColumns1=[].concat(n),r.table.data=[].concat(function(t){if(Array.isArray(t)){for(var r=0,e=Array(t.length);r<t.length;r++)e[r]=t[r];return e}return Array.from(t)}(e.data)),r.table.totalNum=e.totalNum,r.table.validNum=e.validNum,r.table.errorNum=e.data.length}},error:function(t){r.spinShow=!1,console.error(t.message)}})):(r.spinShow=!1,this.$Message.info(t.statusText))},uploadError:function(t){this.$Message.error(t.message)},formatErrorUpload:function(){this.$Message.warning("请上传正确的模板")},formatForm:function(){var t=this.form,r=[];for(var e in t)r.push(encodeURIComponent(e)+"="+encodeURIComponent(t[e]));return r.join("&")},asyncConfigOK:function(){if(this.isShowimport())this.$Message.warning("导入数据有错误信息,请核对");else{var t=this,r=this.form;t.spinShow=!0,r.dataId=t.dataId||"",n.default.confirmSubmit({data:r,success:function(r){if(t.spinShow=!1,0===r.status){utils.number_format({decimals:2,number:t.table.totalBonus,dec_point:".",thousands_sep:","});t.$Modal.success({title:"提示信息",content:"导入成功。"}),t.clearTable()}else t.$Modal.error({title:"提示信息",content:"导入失败，原因为："+r.statusText+"。请联系开发人员处理。"})},error:function(r){t.spinShow=!1,t.$Modal.error({title:"提示信息",content:"导入失败，原因为："+r.statusText+"。请联系开发人员处理。"})}})}}}}}}]);